\section{Stammfunktionen} \proplbl{stammfunktion} \setcounter{equation}{0}
Sei $f:D\subset K^n\to K^{m\times n}$ ($\cong L(K^n, K^m)$)

\begin{underlinedenvironment}[Frage]
	Existiert eine Funktion $F$ mit $F' = f$ auf $D$?
\end{underlinedenvironment}

\begin{*definition}
	$F: D\subset K^n\to K^m$ heißt \begriff{Stammfunktion} oder \emph{unbestimmtes} \begriff{Integral}[!unbestimmt] von $f$ auf $D$, falls $F$ \gls{diffbar} und $F'(x) = f(x)$ $\forall x\in D$
\end{*definition}

\begin{proposition}
	\proplbl{stammfunktion_uneindeutigkeit_stammfunktion}
	Sei $F:D\subset K^n\to K^m$ Stammfunktion von $f:D\to K^{m\times n}$ und sei $D\subset K^n$ Gebiet\marginnote{Gebiet = offen \& zusammenhängend}. Dann:
	
	\begin{tabularx}{\linewidth}{X@{\ \ }c@{\ \ }X}
		\hfill$\tilde{F}$ ist Stammfunktion von $f$ auf $D$ & $\Leftrightarrow$ & $\tilde{F} = F + c$ für $c\in K^{m}$
	\end{tabularx}

	Falls $f$ eine Stammfunktion besitzt, dann gibt es eine Menge von Stammfunktionen, die auf einem Gebiet bis auf eine additive Konstante eindeutig bestimmt sind. Für eine Stammfunktion schreibt man auch \begin{align*}
		\int f \D x \text{ bzw. } \int f(x) \D x
	\end{align*}
	Das Symbol steht für die \emph{Menge} aller Stammfunktionen. Man schreibt aber auch \begin{align*}
		F = \int f \D x,
	\end{align*} falls es \emph{eine} Stammfuznktion gleich $F$ gibt.
	
	Weiterhin verwendet man $\int f\D x$ auch als Bezeichnung für den \emph{Funktionswert} $F(x)$ einer Stammfunktion $F$ von $f$. Somit Vorsicht bei der Bezeichnung (vgl. Kontext).
\end{proposition}

\begin{proof}
	\marginnote{Intervall $I\subset\mathbb{R}$ sind zusammenhängend} \hspace*{0pt}
	\begin{itemize}[topsep=\dimexpr -\baselineskip / 2\relax]
		\item["`$\Leftarrow$"'] Offenbar $F$ \gls{diffbar} mit $\tilde{F}' = F' = f$
		\item["`$\Rightarrow$"'] Offenbar $\tilde{F}'(x) - F'(x) = 0$ $\forall x\in D$ 
		$\xRightarrow{\propref{mittelwertsatz_ableitung_null_konstante_funktion}}$ $\tilde{F}(x) - F(x) = c$ für ein $c\in K^m$
	\end{itemize}
\end{proof}

Sei $f,g:D\subset K^n\to K^{m\times n}$, $D$ Gebiet, $c\in K$. Dann liefert \propref{stammfunktion_uneindeutigkeit_stammfunktion} und Differentiationsregeln
\begin{equation}\label{xx}
\begin{split}
\int (f\pm g) \D x &= \int f \D x \pm \int g \D x \\
\int c f \D x &= c \int f \D x
\end{split}
\end{equation}
Falls jeweils die rechte Seite existiert, d.h. $f\to \int f\D x$ ist in gewisser Weise linear.

\begin{underlinedenvironment}
	Aussage bleibt richtig, wenn $D$ nur offen, wir beschränken uns meist aber auf Gebiete.
\end{underlinedenvironment}

Betrachte zunächst den \emph{Spezialfall} $n=m=1$. Sei $f:D\subset K\to K$, $D$ offen. Die Beispiele zur Differentiation liefern folgende Stammfunktionen

\begin{minipage}{0.45\linewidth}
	\begin{flushleft}
		für $K=\mathbb{R}$ und $K = \mathbb{C}$:
	\end{flushleft}
	\vspace*{1mm}
	\renewcommand{\arraystretch}{1.2}
	\begin{tabularx}{\linewidth}{llX}
		\toprule
		$f(x)$ & \multicolumn{2}{l}{Stammfunktion $F(x)$} \\
		\midrule
		$\sin x$ & $-\cos x$ & \\
		$\cos x$ & $\sin x$ & \\
		$e^x$ & $e^x$ & \\
		$x^k$ & $\frac{1}{k+1} x^{k+1}$ & ($k\in\mathbb{Z}\setminus\{-1\})$ \\
		\bottomrule
	\end{tabularx}
\end{minipage}
\hfill%
\begin{minipage}{0.45\linewidth}
	\begin{flushleft}
		für $K=\mathbb{R}$:
	\end{flushleft}
	\vspace*{1mm}
	\renewcommand{\arraystretch}{1.2}
	\begin{tabularx}{\linewidth}{llX}
		\toprule
		$f(x)$ & \multicolumn{2}{l}{Stammfunktion $F(x)$} \\
		\midrule
		$a^x$ & $\frac{a^x}{\ln a}$ & \\
		$x^\alpha$ & $\frac{1}{\alpha + 1} x^{\alpha + 1}$ & ($x > 0$, $\alpha \in \mathbb{R}\setminus \{ - 1\})$ \\
		$\frac{1}{x}$ & $\ln\vert x\vert$ & ($x\in\mathbb{R}\setminus \{0\}$) \\
		$\frac{1}{1+x^2}$ & $\arctan x$ & \\
		\bottomrule
	\end{tabularx}
\end{minipage}

\begin{underlinedenvironment}[Strategie]
	Rechenregeln für weitere Stammfunktionen
\end{underlinedenvironment}
\begin{proposition}[partielle Integration]
	\proplbl{stammfunktion_partielle_integration}
	Seien $f,g:D\subset K\to K$, $D$ Gebiet mit zugehörigen Stammfunktion $F, G:D\to K$.
	
	Falls $f\cdot G:D\to K$ Stammfunktion, dann auch $(F\cdot g):D\to K$ mit \begin{align}
		\proplbl{stammfunktion_partielle_integration_eq}
		\int F\cdot g \D x = F(x) G(x) - \int f\cdot G\D x
	\end{align}
\end{proposition}

\begin{underlinedenvironment}[Interpretation von \eqref{stammfunktion_partielle_integration_eq}]
	Es gibt eine Stammfunktion $\widehat{F\cdot g}$ von $F\cdot g$ und eine Stammfunktion $\widehat{f \cdot G}$ von $f\cdot G$ mit \begin{align}
		\tag{2'} \widehat{F\cdot g}(x) = F(x) G(x) - \widehat{f\cdot G}(x)
	\end{align}
\end{underlinedenvironment}

\begin{remark}
	\eqref{stammfunktion_partielle_integration_eq} kann als Umkehrung der Produktregel betrachtet werden.
\end{remark}

\begin{proof}
	Sei $H:D\to K$ Stammfunktion von $f\cdot G$ \\
	$\Rightarrow$ $\frac{\D}{\D x} \left(F(x) G(x) - H(x)\right) = F'(x)\cdot G(x) + F(x) \cdot G'(x) - H'(x) = f(x)\cdot G(x) + F(x) \cdot g(x) - f(X)\cdot G(x) = F(x) \cdot g(x)$ \\
	$\Rightarrow$ Behauptung
\end{proof}

\begin{example}
	\proplbl{stammfunktion_beispiel_lnx}
	Zeige $\int \ln x \D x = x\ln x - x$ auf $\mathbb{R}_{>0}$, denn \begin{align*}
		\int \ln x \D x = \int \underbrace{1\cdot \ln x}_{g\cdot F} \overset{\eqref{stammfunktion_partielle_integration_eq}}{=} x\cdot \ln x - \int x\cdot \frac{1}{x} \D x  = x\cdot \ln x - x\end{align*}
\end{example}

\begin{example}
	Bestimme $\int x^2 e^x\D x$.
	
	Es ist \begin{align*}
		\int \underbrace{x^2 e^x}_{F\cdot g} \D x &\overset{\eqref{stammfunktion_partielle_integration_eq}}{=} x^2 e^x - \int \underbrace{2x\cdot e^x}_{f\cdot G} \\
		\int \underbrace{2x\cdot e^x}_{\tilde{F}\cdot \tilde{g}} \D x &\overset{\eqref{stammfunktion_partielle_integration_eq}}{=} \underbrace{2x\cdot e^x}_{\tilde{F}\cdot \tilde{G}} - \int \underbrace{2 e^x}_{\tilde{f}\cdot \tilde{G}} \D x = 2 x e^x - 2 e^x
	\end{align*}
	$\Rightarrow$ $\int x^2 e^x \D x = x^2 e^x - 2 x e^x + 2 e^x = e^x (x^2 - 2x + 2)$
\end{example}

\begin{proposition}[Integration durch Substitution]
	\proplbl{stammfunktion_substitution}
	Sei $f:D\subset K\to K$, $D$ Gebiet, mit Stammfunktion $F:D\to K$ und sei $\phi:D\to D$ \gls{diffbar}. Dann hat $f(\phi(.))\cdot \phi'(.):D\to K$ eine Stammfunktion mit \begin{align}
		\proplbl{stammfunktion_substitution_eq}
		\int f(\phi(x))\cdot\phi'(x)\D x &= F(\phi(x))
	\end{align}
\end{proposition}

\begin{underlinedenvironment}[Interpretation]
	analog zu \eqref{stammfunktion_partielle_integration_eq}
\end{underlinedenvironment}

\begin{remark}
	\eqref{stammfunktion_substitution_eq} kann als Umkehrung der Kettenregel angesehen werden.
\end{remark}

\begin{proof}
	$F(\phi(.))$ ist nach der Kettenregel auf $D$ \gls{diffbar} mit \begin{align*}
		\frac{\D}{\D x} F(\phi(x)) &= F'(\phi(x)) \cdot \phi'(x) = f(\phi(x)) \cdot \phi'(x)
	\end{align*}
\end{proof}

\begin{example}
	Bestimme $\int \frac{\ln x}{x^2} \D x$ auf $\mathbb{R}_{>0}$:
	
	\begin{itemize}
		\item Offenbar ist $\frac{\ln x}{x^2} = - \frac{1}{x^2}\cdot \ln \frac{1}{x}$.
	
		\item Wähle $\phi(x):= \frac{1}{x}$, $f(y):= \ln y$\\
		 $\Rightarrow$ $\phi'(x) = -\frac{1}{x^2}$ $F(y) = y\cdot \ln y - y$ Stammfunktion von $f$ (siehe \propref{stammfunktion_beispiel_lnx}),
	
		\item  $f(\phi(x))\cdot \phi'(x) = - \frac{1}{x^2} - \ln \frac{1}{x}$ \\
		$\xRightarrow{\eqref{stammfunktion_substitution_eq}}$ $\displaystyle F(\phi(x)) = \frac{1}{x}\cdot \ln \frac{1}{x} - \frac{1}{x} = - \frac{1 + \ln x}{x} = \int \frac{\ln x}{x^2} \D x$
	\end{itemize}
\end{example}

Weitere Regeln prüft man leicht durch Differentiation:
\begin{proposition}
	Sei $f:I\subset \mathbb{R}\to \mathbb{R}$, $I$ offenes Intervall, $f(x)\neq 0$ auf $I$, dann gilt \begin{align}
		\int \frac{f'(x)}{f(x)} \D x = \ln \vert f(x) \vert
	\end{align}
\end{proposition}

\begin{example}
	Betrachte $f(x) = \tan x$ $\forall x\in I_k:= \left( - \frac{\pi}{2} + k\cdot \pi, \frac{\pi}{2} + k\cdot \pi\right)$, $k\in\mathbb{Z}$. Dann \begin{align*}
		\int \tan x \D x = \int \frac{\sin x}{\cos x} = - \int \frac{(\cos x)'}{\cos x} = - \ln \vert \cos x \vert
	\end{align*}
\end{example}

\begin{underlinedenvironment}[Wieder allgemeine Fall]
	mit $f:D\subset K^n\to K^{m\times n}$
\end{underlinedenvironment}
\begin{underlinedenvironment}[Reduktion]
	Nach \propref{richtungsableitung_vollstaendige_reduktion} kann man sich auf $m=1$ beschränken, d.h. falls \begin{align*}
		f = \begin{pmatrix}
		 f_{11} & \dotsc & f_{1k} \\ \vdots & & \vdots \\ f_{m1} & \dotsc & f_{mn}
		\end{pmatrix}
	\end{align*}
	reicht eine Untersuchung der Zeilen.
\end{underlinedenvironment}
\begin{underlinedenvironment}[Ziel]
	Reduktion auf $n=1$. Betrachte somit $f:D\subset K^n\to K^n$, $D$ Gebiet ($m=1$, $n$ beliebig).
	
	Sei $F:D\subset K^n\to K$ Stammfunktion von $f=(f_1, \dotsc, f_n)$ \\
	\begin{tabularx}{\linewidth}{r@{\ \ }X}
	$\xRightarrow{\ref{richtungsableitung_vollstaendige_reduktion}}$ & $F_{x_j}(x) = f_j(x)$ $\forall x\in D$, $j = 1,\dotsc, n$ \\
	$\Rightarrow$ & $x_j \to F(x_1, \dotsc, x_j, \dotsc, x_n)$ ist Stammfunktion von $x_j \to f_j(x_1, \dotsc, x_j, \dotsc, x_n)$. Hierbei sind $x_i$ mit $i\neq j$ als Parameter anzusehen. \\
	$\Rightarrow$ & Ist $x_j \to F_j(x_1, \dotsc, x_j, \dotsc, x_n)$ \emph{eine} Stammfunktion von $x_j\to f_j(x_1, \dotsc, x_j, \dotsc, x_n)$, dann erhält man \emph{alle} Stammfunktionen durch Addition einer Konstanten, die jedoch von den Parametern abhängen kann, d.h. durch
	\end{tabularx}
	{
		\stepcounter{equation} \zeroAmsmathAlignVSpaces
		\begin{align}\proplbl{stammfunktion_reduktion_konstante}
			x_j\to F_j(x_1, \dotsc, x_j, \dotsc, x_n) + \phi_j(x_1, \dotsc, x_{j-1}, x_{j+1}, \dotsc, x_n)
		\end{align}}
		\vspace*{1mm}
		\begin{tabularx}{\linewidth}{r@{\ \ }X}
		\parbox{\widthof{$\xRightarrow{\ref{richtungsableitung_vollstaendige_reduktion}}$}}{\hfill} & mit beliebiger Funktion $\phi_j$. Schließlich muss gelten
	\end{tabularx}
	\begin{align}
	\proplbl{stammfunktion_reduktion_bedingung_konstante}
	\frac{\partial}{\partial x_j} \left( F_j(x_1, \dotsc, x_{j-1}, x_{j+1}, \dotsc, x_n)\right) &= f_i(x)\quad\forall i\neq j, j=1\dotsc, n
	\end{align}
\end{underlinedenvironment}

\begin{example}
	\proplbl{stammfunktion_beispiel_11}
	Betrachte $f:\mathbb{R}^2\to \mathbb{R}^2$ mit $f(x,y) = \begin{pmatrix}
		\alpha xy \\ x² + y^2
	\end{pmatrix}$ ($\alpha$ ist Parameter)
	
	\begin{enumerate}[label={\arabic*)}]
		\item Suche eine Stammfunktion von $x\to f_1(x,y)$: \begin{align*}
		F(x,y) &= \underbrace{\frac{\alpha}{2} x^2 y}_{=F_1(x,y)} + \phi_1(y)\;\; \text{$\phi_1$ unbekannte Funktion}
		\end{align*}
		\item Suche eine Stammfunktion von $y\to f_2(x,y)$: \begin{align*}
		F(x,y) &= \underbrace{x^2 y + \frac{1}{3}y^3}_{F_2(x,y)} + \phi_2(x) \;\; \text{($\phi_2$ unbekannte Funktion)}
		\end{align*}
		\item 
		$\xRightarrow{\eqref{stammfunktion_reduktion_bedingung_konstante}}$ $F_y(x,y) = \frac{\partial}{\partial y} \big(F_1(x,y) + \phi_1(y)\big) \overset{\eqref{stammfunktion_reduktion_bedingung_konstante}}{=} f_2(x,y)$, d.h. \begin{equation}
			\begin{split}
			\proplbl{stammfunktion_beispiel_reduktion_schritt1}
			\frac{\alpha}{2} x^2 + \phi_1'(y) &= x^2 + y^2 \\
			\phi_1'(y) &= \left( 1 - \frac{\alpha}{2}\right) x^2 + y^2 \quad \forall x,y
			\end{split}
			\end{equation}
			Offenbar kann \eqref{stammfunktion_beispiel_reduktion_schritt1} nur gelten, falls rechte Seite unabhängig von $x$, d.h. für $\alpha=2$ (für $\alpha\neq 2$ existiert \emph{keine} Stammfunktion von $f$). \\
			$\xRightarrow{\eqref{stammfunktion_beispiel_reduktion_schritt1}}$ $\phi_1(y) = \frac{1}{3} y^3 + c_1$ ($c_1$ Konstante)
	
	\item analog: $F_y(x,y) = \frac{\partial}{\partial x} \big(F_2(x,y) + \phi_2'(x) \big) = f_1(x, y)$ \\
	$\Rightarrow$ $\phi_2'(x) = (\alpha - 2) xy \overset{\alpha = 2}{=} 0$ \\
	$\Rightarrow$ $\phi_2(x) = c_2$ ($c_2$ Konstante)
	\end{enumerate}
	
	$\Rightarrow$ $F(x,y) = F_1(x,y) + \phi_1(y) = F_2(x,y) + \phi_2(x,y) = x^2 y + \frac{1}{3} y^3 + c$, $c\in \mathbb{R}$ beliebig, sind alle Stammfunktionen von $f$ (Probe!).
\end{example}

\begin{remark}
	\vspace*{0pt}
	\begin{itemize}
		\item Mit obiger Strategie wird die Bestimmung einer Stammfunktion auf $n=1$ zurückgeführt.
		\item Nicht alle Funktionen besitzen eine Stammfunktion
	\end{itemize}
\end{remark}

\begin{underlinedenvironment}[Ausblick auf Kapitel 27]
	In Kapitel 27 formulieren wir eine notwendige Bedingung im Satz 27.18 ("`Integrabilitätsbedingung"') für die Existenz einer Stammfunktion (die in gewissen Mengen $D$ auch hinreichend ist): \begin{align*}
		\frac{\partial}{\partial x_j} f_i(x) &= \frac{\partial}{\partial x_i} f_j(x) \quad \forall i,j,x\in D
	\end{align*}
\end{underlinedenvironment}